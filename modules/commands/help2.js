
module.exports.config = {
  name: "help2",
  version: "1.0.0",
  hasPermssion: 0,
  credits: "ğŠğ€ğ’ğ‡ğˆğ… ğ‘ğ€ğ™ğ€",
  description: "Detailed command list with usage",
  commandCategory: "Command List",
  usages: "[Module Name]",
  cooldowns: 5,
  envConfig: {
    autoUnsend: true,
    delayUnsend: 60
  }
};

module.exports.languages = {
  "en": {
    "moduleInfo": "â‰¿â”â”â”â”à¼ºâ€à¼»â”â”â”â”â‰¾\nğŸ“œ ğŒğ¨ğğ®ğ¥ğ: %1\nğŸ“ ğƒğğ¬ğœğ«ğ¢ğ©ğ­ğ¢ğ¨ğ§: %2\n\nÂ» ğŸ‘‘ ğ‚ğ«ğğğ¢ğ­ğ¬: %7\nÂ» ğŸ“„ ğ”ğ¬ğšğ ğ: %3\nÂ» ğŸ“‚ ğ‚ğšğ­ğğ ğ¨ğ«ğ²: %4\nÂ» â± ğ‚ğ¨ğ¨ğ¥ğğ¨ğ°ğ§: %5 ğ¬ğğœğ¨ğ§ğ(ğ¬)\nÂ» ğŸ‘¥ ğğğ«ğ¦ğ¢ğ¬ğ¬ğ¢ğ¨ğ§: %6\nâ‰¿â”â”â”â”à¼ºâ€à¼»â”â”â”â”â‰¾\nğŸ’¥ ğğ©ğğ«ğšğ­ğğ ğ›ğ² ğŠğ€ğ’ğ‡ğˆğ… ğ‘ğ€ğ™ğ€ ğŸ’¥",
    "helpList": "à¼»ï¹¡ï¹¡ï¹¡ï¹¡ï¹¡ï¹¡ï¹¡à¼º\nğŸ¤– ğ“ğ¡ğ¢ğ¬ ğ›ğ¨ğ­ ğœğ®ğ«ğ«ğğ§ğ­ğ¥ğ² ğ¡ğšğ¬ %1 ğœğ¨ğ¦ğ¦ğšğ§ğğ¬.\nğŸŒŸ ğ”ğ¬ğ: \"%2help2 <command>\" ğ­ğ¨ ğ¤ğ§ğ¨ğ° ğğğ­ğšğ¢ğ¥ğ¬.\nâš ï¸ ğğ¥ğğšğ¬ğ ğğ¨ ğ§ğ¨ğ­ ğ¬ğ©ğšğ¦ ğ¨ğ« ğšğ›ğ®ğ¬ğ ğ­ğ¡ğ ğ›ğ¨ğ­.\nà¼»ï¹¡ï¹¡ï¹¡ï¹¡ï¹¡ï¹¡ï¹¡à¼º",
    "user": "User",
    "adminGroup": "Group Administrator",
    "adminBot": "Bot Administrator"
  },
  "vi": {
    "moduleInfo": "â‰¿â”â”â”â”à¼ºâ€à¼»â”â”â”â”â‰¾\nğŸ“œ ğŒğ¨ğğ®ğ¥ğ: %1\nğŸ“ ğƒğğ¬ğœğ«ğ¢ğ©ğ­ğ¢ğ¨ğ§: %2\n\nÂ» ğŸ‘‘ ğ‚ğ«ğğğ¢ğ­ğ¬: %7\nÂ» ğŸ“„ ğ”ğ¬ğšğ ğ: %3\nÂ» ğŸ“‚ ğ‚ğšğ­ğğ ğ¨ğ«ğ²: %4\nÂ» â± ğ‚ğ¨ğ¨ğ¥ğğ¨ğ°ğ§: %5 ğ¬ğğœğ¨ğ§ğ(ğ¬)\nÂ» ğŸ‘¥ ğğğ«ğ¦ğ¢ğ¬ğ¬ğ¢ğ¨ğ§: %6\nâ‰¿â”â”â”â”à¼ºâ€à¼»â”â”â”â”â‰¾\nğŸ’¥ ğğ©ğğ«ğšğ­ğğ ğ›ğ² ğŠğ€ğ’ğ‡ğˆğ… ğ‘ğ€ğ™ğ€ ğŸ’¥",
    "helpList": "à¼»ï¹¡ï¹¡ï¹¡ï¹¡ï¹¡ï¹¡ï¹¡à¼º\nğŸ¤– ğ“ğ¡ğ¢ğ¬ ğ›ğ¨ğ­ ğœğ®ğ«ğ«ğğ§ğ­ğ¥ğ² ğ¡ğšğ¬ %1 ğœğ¨ğ¦ğ¦ğšğ§ğğ¬.\nğŸŒŸ ğ”ğ¬ğ: \"%2help2 <command>\" ğ­ğ¨ ğ¤ğ§ğ¨ğ° ğğğ­ğšğ¢ğ¥ğ¬.\nâš ï¸ ğğ¥ğğšğ¬ğ ğğ¨ ğ§ğ¨ğ­ ğ¬ğ©ğšğ¦ ğ¨ğ« ğšğ›ğ®ğ¬ğ ğ­ğ¡ğ ğ›ğ¨ğ­.\nà¼»ï¹¡ï¹¡ï¹¡ï¹¡ï¹¡ï¹¡ï¹¡à¼º",
    "user": "User",
    "adminGroup": "Group Administrator",
    "adminBot": "Bot Administrator"
  }
};

module.exports.handleEvent = function ({ api, event, getText }) {
  const { commands } = global.client;
  const { threadID, messageID, body } = event;

  if (!body || typeof body == "undefined" || body.indexOf("help2") != 0) return;
  const splitBody = body.slice(body.indexOf("help2")).trim().split(/\s+/);
  if (splitBody.length == 1 || !commands.has(splitBody[1].toLowerCase())) return;
  const threadSetting = global.data.threadData.get(parseInt(threadID)) || {};
  const command = commands.get(splitBody[1].toLowerCase());
  const prefix = (threadSetting.hasOwnProperty("PREFIX")) ? threadSetting.PREFIX : global.config.PREFIX;
  return api.sendMessage(getText("moduleInfo", command.config.name, command.config.description, `${prefix}${command.config.name} ${(command.config.usages) ? command.config.usages : ""}`, command.config.commandCategory, command.config.cooldowns, ((command.config.hasPermssion == 0) ? getText("user") : (command.config.hasPermssion == 1) ? getText("adminGroup") : getText("adminBot")), command.config.credits), threadID, messageID);
}

module.exports.run = function({ api, event, args, getText }) {
  const { commands } = global.client;
  const { threadID, messageID } = event;
  const command = commands.get((args[0] || "").toLowerCase());
  const threadSetting = global.data.threadData.get(parseInt(threadID)) || {};
  const { autoUnsend, delayUnsend } = global.configModule[this.config.name];
  const prefix = (threadSetting.hasOwnProperty("PREFIX")) ? threadSetting.PREFIX : global.config.PREFIX;

  if (!command) {
    const arrayInfo = [];
    const page = parseInt(args[0]) || 1;
    const numberOfOnePage = 8;
    let i = 0;
    let msg = "âšâ”€â”€â­’â”€â­‘â”€â­’â”€â”€âš\nğŸ“– ğƒğğ­ğšğ¢ğ¥ğğ ğ‚ğ¨ğ¦ğ¦ğšğ§ğ ğ‹ğ¢ğ¬ğ­:\n\n";

    for (var [name, value] of (commands)) {
      const usage = value.config.usages ? ` ${value.config.usages}` : "";
      const commandInfo = `â•°â”ˆâ¤${name}\nâª¼ ğ”ğ¬ğšğ ğ: ${prefix}${name}${usage}\nâª¼ ğ‚ğšğ­ğğ ğ¨ğ«ğ²: ${value.config.commandCategory}\nâª¼ ğƒğğ¬ğœğ«ğ¢ğ©ğ­ğ¢ğ¨ğ§: ${value.config.description}\nâª¼ ğ‚ğ¨ğ¨ğ¥ğğ¨ğ°ğ§: ${value.config.cooldowns}s\nâª¼ ğğğ«ğ¦ğ¢ğ¬ğ¬ğ¢ğ¨ğ§: ${((value.config.hasPermssion == 0) ? getText("user") : (value.config.hasPermssion == 1) ? getText("adminGroup") : getText("adminBot"))}`;
      arrayInfo.push(commandInfo);
    }

    arrayInfo.sort((a, b) => a.data - b.data);

    const startSlice = numberOfOnePage*page - numberOfOnePage;
    i = startSlice;
    const returnArray = arrayInfo.slice(startSlice, startSlice + numberOfOnePage);

    for (let item of returnArray) msg += `âŸ¬${++i}âŸ­\n${item}\n\n`;
    const text = `â‰¿â”â”â”â”à¼ºâ€à¼»â”â”â”â”â‰¾\nâŠ¶ ğğšğ ğ (${page}/${Math.ceil(arrayInfo.length/numberOfOnePage)})\nâŠ¶ ğ”ğ¬ğ: "${prefix}help2 <command>" ğŸğ¨ğ« ğğğ­ğšğ¢ğ¥ğ¬.\nâŠ¶ ğ“ğ¨ğ­ğšğ¥: ${arrayInfo.length} ğœğ¨ğ¦ğ¦ğšğ§ğğ¬.\nâŠ¶ ğ”ğ¬ğ ${prefix}help2 <page number>`;
    return api.sendMessage(msg + text, threadID, async (error, info) => {
      if (autoUnsend) {
        await new Promise(resolve => setTimeout(resolve, delayUnsend * 60000));
        return api.unsendMessage(info.messageID);
      } else return;
    });
  }

  return api.sendMessage(getText("moduleInfo", command.config.name, command.config.description, `${prefix}${command.config.name} ${(command.config.usages) ? command.config.usages : ""}`, command.config.commandCategory, command.config.cooldowns, ((command.config.hasPermssion == 0) ? getText("user") : (command.config.hasPermssion == 1) ? getText("adminGroup") : getText("adminBot")), command.config.credits), threadID, messageID);
};
